********************************************************************************** (0) Globals and Locals*******************************************************************************clear allvers 10.1 cap log closeforeach ado in ivreg2 outreg2 estout ranktest mat2txt plausexog {	cap which `ado'	if _rc!=0 ssc install `ado'}* DIRECTORIESglobal Directory /Users/pedm/Documents/jobs/Damian-Clarkeglobal Data    "${Directory}/Data"global Source  "${Directory}/Code"global Log     "${Directory}/Log"global Graphs  "${Directory}/Results/Graphs"global Tables  "${Directory}/Results/Outreg"foreach dirname in Summary Twin OLS RF IV Conley {	cap mkdir "$Tables/`dirname'"}* VARIABLES* We cannot obtain a measure of educf - Mother's years of education * Instead we use natural_mother_education_NVQ - mothers edu level* TODO: _contracep* - contraceptive use and intention* TODO: agefirstbirth * TODO: search for a mothers year of education, or similar* Original:* global base malec _country* _yb* _contracep** global age motherage motheragesq motheragecub agefirstbirth * global S educf educfyrs_sq******** TODO: make that a Z score for qualityglobal outcomes Quality_EVSTSCOglobal base malec _country* _yb* _dob*global age motherage motheragesq motheragecubglobal S _mother_edu*global H height bmi * ECONOMETRIC SPECIFICATIONS* Only include CM that are available in Wave 5local cond if Quality_EVSTSCO != .local se cluster(MCSID)local wt [pw=sweight]/*local conditions  ALL==1  age>=11  age<11  child_yob<=1984  child_yob>1984  income=="low"  income=="mid"  gender=="F"  gender=="M";local fnames  All  Over11  Under10  BornPre1985  BornPost1984  LowIncome  MidIncome  Girls  Boys;*/********************************************************************************** (1) Setup (+ discretionary choices)*******************************************************************************use "${Data}/Final/QQ-Ready-for-Regressions.dta"gen ALL = 1replace bmi=. if bmi>50replace height=. if height>2.4replace height=. if height<0.8* Generate dummy varstab country, gen(_country)tab year_birth, gen(_yb)tab natural_mother_education_NVQ, gen(_mother_edu)tab bord, gen(_bord)* All CM are born between 200-2002, thus this is a better measure than agetostring CM_DOB_Month CM_DOB_Year, replacegen CM_dob = CM_DOB_Year + "." + CM_DOB_Monthtab CM_dob, gen(_dob)/*tab contracep_intent, gen(_contracep)drop if twinfamily>2gen cat="Low Inc, Singleton" if twind==0 & inc_status=="L"replace cat="Low Inc, Twin" if twind==1 & inc_status=="L"replace cat="Mid Inc, Single" if twind==0 & inc_status!="L"replace cat="Mid Inc, Twin" if twind==1 & inc_status!="L"encode cat, gen(catnum)egen category=concat(income twindfamily)egen nonmiss = rowmiss(educf height bmi motherage malec)*/************************************************************************************ (2) Simple OLS of Q-Q (can then apply Altonji)********************************************************************************	* Note: i.bord does not work in stata 10.1. 	* Instead we use _bord* as a dummy for each		local out "${Tables}/OLS/QQ_ols.xls"	cap rm "`out'"	cap rm "${Tables}/OLS/QQ_ols.txt"		* ORIGINALLY: ALL==1 income=="low" income=="mid" 	foreach inc in ALL==1 income_quint==1 income_quint>1&income_quint<5 {		preserve		di "`cond' & `inc'"		keep `cond' & `inc'		foreach y of varlist $outcomes {						qui reg `y' fert $base $age $S $H, `se'						qui reg `y' fert $base $age `wt' if e(sample), `se'			outreg2 fert $age using "`out'", excel append						qui reg `y' fert $base $age $H `wt' if e(sample), `se'			outreg2 fert $age $H using "`out'", excel append						qui reg `y' fert $base $age $S $H `wt', `se'			outreg2 fert $age $S $H using "`out'", excel append			qui reg `y' fert $base $age $S $H _bord* `wt', `se'			outreg2 fert $age $S $H using "`out'", excel append			}		restore	}